wp_optimize_send_command_admin_ajax=function(t,e,i,o,n){o="undefined"==typeof o||o,e||(e={}),e.hasOwnProperty("include_ui_elements")||(e.include_ui_elements=!0);var s={action:"wp_optimize_ajax",subaction:t,nonce:wp_optimize_ajax_nonce,data:e},a={type:"post",data:s,success:function(t){if(o){try{var e=wpo_parse_json(t)}catch(n){return console.log(n),console.log(t),void alert(wpoptimize.error_unexpected_response)}"function"==typeof i&&i(e)}else"function"==typeof i&&i(t)}};return"object"==typeof n&&n.hasOwnProperty("timeout")&&(a.timeout=n.timeout),jQuery.ajax(ajaxurl,a)},jQuery(document).ready(function(t){WP_Optimize=WP_Optimize(wp_optimize_send_command_admin_ajax),"undefined"!=typeof WP_Optimize_Cache&&(WP_Optimize_Cache=WP_Optimize_Cache(wp_optimize_send_command_admin_ajax))});var WP_Optimize=function(send_command){function enable_or_disable_schedule_options(){if($("#enable-schedule").length){var t=$("#enable-schedule").is(":checked");t?$("#wp-optimize-auto-options").css("opacity","1"):$("#wp-optimize-auto-options").css("opacity","0.5")}}function temporarily_display_notice(t,e,i){e="undefined"==typeof e?"#wp-optimize-wrap":e,i="undefined"==typeof i?15:i,$(t).hide().prependTo(e).slideDown("fast").delay(1e3*i).slideUp("fast",function(){$(this).remove()})}function enable_or_disable_feature(t,e){var i={type:t,enable:e?1:0};$("#"+t+"_spinner").show(),send_command("enable_or_disable_feature",i,function(e){if($("#"+t+"_spinner").hide(),e&&e.hasOwnProperty("output"))for(var i=0,o=e.output.length;i<o;i++){var n='<div class="updated"><p>'+e.output[i]+"</p></div>";temporarily_display_notice(n,"#"+t+"_notice")}})}function toggle_mobile_menu(t){t?$("#wp-optimize-wrap").addClass("wpo-mobile-menu-opened"):$("#wp-optimize-wrap").removeClass("wpo-mobile-menu-opened")}function gather_settings(t){var e="",t="undefined"==typeof t?"string":t;return"object"==t?e=$("#wp-optimize-general-settings form input[name!='action'], #wp-optimize-general-settings form textarea, #wp-optimize-general-settings form select, #wp-optimize-nav-tab-contents-optimize input[type='checkbox'], .wp-optimize-nav-tab-contents input[name^='enable-auto-backup-']").serializeJSON({useIntKeysAsArrayIndex:!0}):(e=$("#wp-optimize-general-settings form input[name!='action'], #wp-optimize-general-settings form textarea, #wp-optimize-general-settings form select, #wp-optimize-nav-tab-contents-optimize input[type='checkbox'], .wp-optimize-nav-tab-contents input[name^='enable-auto-backup-']").serialize(),$.each($('#wp-optimize-general-settings form input[type=checkbox], .wp-optimize-nav-tab-contents input[name^="enable-auto-backup-"]').filter(function(t){return 0==$(this).prop("checked")}),function(t,i){var o="0";e+="&"+$(i).attr("name")+"="+o})),e}function process_done(){send_command("optimizations_done",{},function(){})}function process_queue(){if(!queue.get_lock())return void(debug_level>0&&console.log("WP-Optimize: process_queue(): queue is currently locked - exiting"));debug_level>0&&console.log("WP-Optimize: process_queue(): got queue lock");var t=queue.peek();return"object"==typeof t?(data=t,t=t.optimization_id):data={},"undefined"==typeof t?(debug_level>0&&console.log("WP-Optimize: process_queue(): queue is apparently empty - exiting"),queue.unlock(),void process_done()):(debug_level>0&&console.log("WP-Optimize: process_queue(): processing item: "+t),queue.dequeue(),$(document).trigger(["do_optimization_",t,"_start"].join("")),void send_command("do_optimization",{optimization_id:t,data:data},function(e){if($("#optimization_spinner_"+t).hide(),$("#optimization_checkbox_"+t).show(),$(".optimization_button_"+t).prop("disabled",!1),$(document).trigger(["do_optimization_",t,"_done"].join(""),e),e){for(var i="",o=0,n=e.errors.length;o<n;o++)i+='<span class="error">'+e.errors[o]+"</span><br>";for(var o=0,n=e.messages.length;o<n;o++)i+=e.errors[o]+"<br>";for(var o=0,n=e.result.output.length;o<n;o++)i+=e.result.output[o]+"<br>";if($("#optimization_info_"+t).html(i),e.hasOwnProperty("status_box_contents")&&$("#wp_optimize_status_box").css("opacity","1").find(".inside").html(e.status_box_contents),e.hasOwnProperty("table_list")&&$("#wpoptimize_table_list tbody").html($(e.table_list).find("tbody").html()),e.hasOwnProperty("total_size")&&$("#optimize_current_db_size").html(e.total_size),"optimizetables"==t&&data.optimization_table&&(queue.is_empty()?($("#optimization_spinner_"+t).hide(),$("#optimization_checkbox_"+t).show(),$(".optimization_button_"+t).prop("disabled",!1),$("#optimization_info_"+t).html(wpoptimize.optimization_complete)):($("#optimization_checkbox_"+t).hide(),$("#optimization_spinner_"+t).show(),$(".optimization_button_"+t).prop("disabled",!0))),e.result.meta&&e.result.meta.hasOwnProperty("awaiting_mod")){var s=e.result.meta.awaiting_mod;s>0?$("#adminmenu .awaiting-mod .pending-count").remove(s):$("#adminmenu .awaiting-mod").remove()}}setTimeout(function(){queue.unlock(),process_queue()},10)}))}function do_optimization(t){var e=$("#wp-optimize-nav-tab-contents-optimize .wp-optimize-settings-"+t);e||console.log("do_optimization: row corresponding to this optimization ("+t+") not found");var i={},o=0;if($('input[type="checkbox"]',$("#optimization_info_"+t)).each(function(){var t=$(this);t.is(":checked")&&(i[t.attr("name")]=t.val(),o++)}),1!=$(".optimization_button_"+t).prop("disabled")){if($("#optimization_checkbox_"+t).hide(),$("#optimization_spinner_"+t).show(),$(".optimization_button_"+t).prop("disabled",!0),$("#optimization_info_"+t).html("..."),"optimizetables"==t){var n=$("#wpoptimize_table_list #the-list tr");$(n).each(function(e){var i=($(this).find("td"),$(this).data("type")),o=$(this).data("tablename"),n=$(this).data("optimizable");if(""!=o&&(1==parseInt(n)||optimization_force)){var s={optimization_id:t,optimization_table:o,optimization_table_type:i,optimization_force:optimization_force};queue.enqueue(s)}})}else if(o>0){data={optimization_id:t};for(var s in i)i.hasOwnProperty(s)&&(data[s]=i[s]);queue.enqueue(data)}else queue.enqueue(t);process_queue()}}function save_sites_list_and_do_action(t){$("#wpo_settings_sites_list").length?send_command("save_site_settings",{"wpo-sites":get_selected_sites_list()},function(){t&&t()}):t&&t()}function get_selected_sites_list(){var t=[];return $('#wpo_settings_sites_list input[type="checkbox"]').each(function(){var e=$(this);e.is(":checked")&&t.push(e.attr("value"))}),t}function run_optimizations(){var t=!1;$("#enable-auto-backup").is(":checked")&&(t=!0),save_auto_backup_options(),1==t?take_a_backup_with_updraftplus(run_optimization):run_optimization()}function take_a_backup_with_updraftplus(t,e){"undefined"==typeof e&&(e="");var i=e?0:1;"function"==typeof updraft_backupnow_inpage_go?updraft_backupnow_inpage_go(function(){$("#updraft-backupnow-inpage-modal").dialog("close"),t&&t()},e,"autobackup",0,i,0,wpoptimize.automatic_backup_before_optimizations):t&&t()}function save_auto_backup_options(){var t=gather_settings("object");t.auto_backup=$("#enable-auto-backup").is(":checked"),send_command("save_auto_backup_option",t)}function define_moreoptions_settings(t,e,i,o){t.on("click",function(){return e.hasClass("wpo_always_visible")||e.toggleClass("wpo_hidden"),!1}),define_select_all_checkbox(i,o)}function define_select_all_checkbox(t,e){t.on("change",function(){t.is(":checked")?e.prop("checked",!0):e.prop("checked",!1),update_wpo_all_items_checkbox_state(t,e)}),e.on("change",function(){update_wpo_all_items_checkbox_state(t,e)}),update_wpo_all_items_checkbox_state(t,e)}function update_wpo_all_items_checkbox_state(t,e){var i=0,o=0;if(e.each(function(){$(this).is(":checked")&&o++,i++}),t.next().is("label")&&t.next().data("label")){var n=t.next(),s=n.data("label");i==o?n.text(s):n.text(s.replace("all",[o," of ",i].join("")))}i==o?t.prop("checked",!0):t.prop("checked",!1)}function run_optimization(){$optimizations=$("#optimizations_list .optimization_checkbox:checked"),$optimizations.sort(function(t,e){return t=$(t).closest(".wp-optimize-settings").data("optimization_run_sort_order"),e=$(e).closest(".wp-optimize-settings").data("optimization_run_sort_order"),t>e?1:t<e?-1:0});var t={};$optimizations.each(function(e){var i=$(this).closest(".wp-optimize-settings").data("optimization_id");return i?(t[i]={active:1},void do_optimization(i)):void console.log("Optimization ID corresponding to pressed button not found")}),send_command("save_manual_run_optimization_options",t)}function run_single_table_optimization(t){var e=t.next(),i=e.next(),o=t.data("table"),n=t.data("type"),s={optimization_id:"optimizetables",optimization_table:o,optimization_table_type:n};t.hide(),single_table_optimization_force.is(":checked")&&(s.optimization_force=!0),e.removeClass("visibility-hidden"),send_command("do_optimization",{optimization_id:"optimizetables",data:s},function(o){if(o.result.meta.tableinfo){var n=t.closest("tr"),s=o.result.meta,a=s.tableinfo;update_single_table_information(n,a),$("#wpoptimize_table_list > tbody:last th:eq(6)").html(['<span style="color:',s.overhead>0?"#0000FF":"#004600",'">',s.overhead_formatted,"</span>"].join(""))}t.prop("disabled",!1),e.addClass("visibility-hidden"),i.show().removeClass("visibility-hidden").delay(2500).fadeOut("fast",function(){t.show()})})}function update_single_table_information(t,e){$("td:eq(2)",t).text(e.rows),$("td:eq(3)",t).text(e.data_size),$("td:eq(4)",t).text(e.index_size),$("td:eq(5)",t).text(e.type),e.is_optimizable?$("td:eq(6)",t).html(['<span style="color:',e.overhead>0?"#0000FF":"#004600",'">',e.overhead,"</span>"].join("")):$("td:eq(6)",t).html('<span color="#0000FF">-</span>')}function update_single_table_optimization_buttons(t){$(".run-single-table-optimization").each(function(){var e=$(this);e.data("disabled")&&(t?e.prop("disabled",!1):e.prop("disabled",!0))})}function is_sites_selected(){return 0==wpo_settings_sites_list.length||0!=$('input[type="checkbox"]:checked',wpo_settings_sites_list).length}function update_optimizations_info_view(t){var e,i,o;if(t)for(e in t)t.hasOwnProperty(e)&&(i=["#wp-optimize-settings-",t[e].dom_id].join(""),o=t[e].info?t[e].info.join("<br>"):"",$(i+" .wp-optimize-settings-optimization-info").html(o))}function update_optimizations_info(){var t=["",get_selected_sites_list().join("_")].join("");get_optimizations_info_cache.hasOwnProperty(t)?update_optimizations_info_view(get_optimizations_info_cache[t]):send_command("get_optimizations_info",{"wpo-sites":get_selected_sites_list()},function(e){e&&(get_optimizations_info_cache[t]=e,update_optimizations_info_view(e))})}function import_settings(t){var e=$("#wpo_import_spinner"),i=$("#wpo_import_success_message"),o=$("#wpo_import_error_message");e.show(),send_command("import_settings",{settings:t},function(t){e.hide(),t&&t.errors&&t.errors.length?(o.text(t.errors.join("<br>")),o.slideDown()):t&&t.messages&&t.messages.length&&(i.text(t.messages.join("<br>")),i.slideDown(),setTimeout(function(){window.location.reload()},500)),$("#wpo_import_settings_btn").prop("disabled",!1)})}function wpo_download_json_file(t,e){var i=document.body.appendChild(document.createElement("a")),o=new Date,n=o.getFullYear(),s=o.getMonth()<10?["0",o.getMonth()].join(""):o.getMonth(),a=o.getDay()<10?["0",o.getDay()].join(""):o.getDay();e=e?e:["wpo-settings-",n,"-",s,"-",a,".json"].join(""),i.setAttribute("download",e),i.setAttribute("style","display:none;"),i.setAttribute("href","data:text/json;charset=UTF-8,"+encodeURIComponent(JSON.stringify(t))),i.click()}function remove_single_db_table(t){var e=t.next(),i=e.next(),o=t.data("table"),n={optimization_id:"orphanedtables",optimization_table:o};e.removeClass("visibility-hidden"),send_command("do_optimization",{optimization_id:"orphanedtables",data:n},function(e){if(e.result.meta.success){var n=t.closest("tr");i.show().removeClass("visibility-hidden"),setTimeout(function(){n.fadeOut("slow",function(){n.remove(),change_actions_column_visibility()})},500)}else{var s=wpoptimize.table_was_not_deleted.replace("%s",o);e.result.meta.message&&(s+="("+e.result.meta.message+")"),alert(s)}}).always(function(){t.prop("disabled",!1),e.addClass("visibility-hidden")})}function change_actions_column_visibility(){var t=$("#wpoptimize_table_list"),e=!0;$("tr",t).each(function(){var t=$(this);if($("button",t).length>0)return e=!1,!1}),$("tr",t).each(function(){var t=$(this);e?$("td:last, th:last",t).hide():$("td:last, th:last",t).show()})}function validate_logger_settings(){var t=!0;return $(".wpo_logger_addition_option, .wpo_logger_type").each(function(){validate_field($(this),!0)?$(this).removeClass("wpo_error_field"):(t=!1,$(this).addClass("wpo_error_field"))}),t?$("#wp-optimize-logger-settings .save_settings_reminder").slideUp():$("#wp-optimize-settings-save-results").show().addClass("wpo_alert_notice").text(wpoptimize.fill_all_settings_fields).delay(5e3).fadeOut(3e3,function(){$(this).removeClass("wpo_alert_notice")}),t}function validate_field(t,e){var i=t.val(),o=t.data("validate");if(!o&&e)return""!=$.trim(i);if(o&&!e&&""==$.trim(i))return!0;var n=!0;switch(o){case"email":for(var s=/\S+@\S+\.\S+/,a=i.split(","),_="",p=0;p<a.length;p++)_=$.trim(a[p]),""!=_&&s.test(_)||(n=!1);break;case"url":var s=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,}))\.?)(?::\d{2,5})?(?:[\/?#]\S*)?$/i;n=s.test(i)}return n}var $=jQuery,debug_level=0,queue=new Updraft_Queue;define_select_all_checkbox($("#select_all_optimizations"),$("#optimizations_list .optimization_checkbox")),enable_or_disable_schedule_options(),$("#enable-schedule").change(function(){enable_or_disable_schedule_options()});var table_list_filter=$("#wpoptimize_table_list_filter"),table_list=$("#wpoptimize_table_list"),table_footer_line=$("#wpoptimize_table_list tbody:last"),tables_not_found=$("#wpoptimize_table_list_tables_not_found");$(function(){$.tablesorter.addParser({id:"sizes",is:function(t){return!1},format:function(s){var kb=1024,mb=1024*kb,gb=1024*mb;return eval(s.toLowerCase().replace(/kb/,["* ",kb].join("")).replace(/mb/,["* ",mb].join("")).replace(/gb/,["* ",gb].join("")).replace(/[^0-9\.\*\s]/g,""))},type:"numeric"}),table_list.tablesorter({theme:"default",widgets:["zebra","rows","filter"],cssInfoBlock:"tablesorter-no-sort",headers:{2:{sorter:"digit"},3:{sorter:"sizes"},4:{sorter:"sizes"},7:{sorter:!1}},widgetOptions:{filter_external:table_list_filter,filter_defaultFilter:{2:"~{query}"}}}),table_list.on("filterEnd",function(){var t=$.trim(table_list_filter.val());""==t?table_footer_line.show():table_footer_line.hide(),0==$("#the-list tr:visible",table_list).length?tables_not_found.show():tables_not_found.hide()})}),$("#wp-optimize-disable-enable-trackbacks-enable").click(function(){enable_or_disable_feature("trackbacks",!0)}),$("#wp-optimize-disable-enable-trackbacks-disable").click(function(){enable_or_disable_feature("trackbacks",!1)}),$("#wp-optimize-disable-enable-comments-enable").click(function(){enable_or_disable_feature("comments",!0)}),$("#wp-optimize-disable-enable-comments-disable").click(function(){enable_or_disable_feature("comments",!1)}),$(".wpo-pages-menu").on("click","a",function(t){t.preventDefault(),$(this).is(".active")||($(".wpo-pages-menu a.active").removeClass("active"),$(".wpo-page.active").removeClass("active"),$(this).addClass("active"),$('.wpo-page[data-whichpage="'+$(this).data("menuslug")+'"]').addClass("active"),window.scroll(0,0),$("#wp-optimize-wrap").trigger("page-change",{page:$(this).data("menuslug")})),$("#wp-optimize-nav-page-menu").trigger("click")}),setTimeout(function(){$("#wp-optimize-wrap").trigger("page-change",{page:$(".wpo-pages-menu a.active").data("menuslug")})},500),$(".nav-tab-wrapper .nav-tab").click(function(t){t.preventDefault();var e=$(this).attr("id"),i=$(this).closest(".nav-tab-wrapper");if(e){if(toggle_mobile_menu(!1),$(this).is('[role="toggle-menu"]'))return void toggle_mobile_menu(!0);i.find(".nav-tab:not(#wp-optimize-nav-tab-"+e+")").removeClass("nav-tab-active"),$(this).addClass("nav-tab-active"),$(this).closest(".wpo-page").find(".wp-optimize-nav-tab-contents").hide(),$("#"+e+"-contents").show()}}),$("#wp-optimize-nav-page-menu").on("click",function(t){t.preventDefault(),$(this).toggleClass("opened")}),$("#wp-optimize-nav-tab-WP-Optimize-optimize-contents").on("click","button.wp-optimize-settings-optimization-run-button",function(){var t=$(this).closest(".wp-optimize-settings").data("optimization_id");return t?void(1!=$(".optimization_button_"+t).prop("disabled")&&($(".optimization_button_"+t).prop("disabled",!0),save_sites_list_and_do_action(function(){$(".optimization_button_"+t).prop("disabled",!1),do_optimization(t)}))):void console.log("Optimization ID corresponding to pressed button not found")}),$("#wp-optimize-nav-tab-WP-Optimize-optimize-contents").on("click","#wp-optimize",function(t){var e=$(this);t.preventDefault(),e.prop("disabled",!0),save_sites_list_and_do_action(function(){e.prop("disabled",!1),run_optimizations()})});var wpo_settings_sites_list=$("#wpo_settings_sites_list"),wpo_settings_sites_list_ul=wpo_settings_sites_list.find("ul").first(),wpo_settings_sites_list_items=$('input[type="checkbox"]',wpo_settings_sites_list_ul),wpo_settings_all_sites_checkbox=wpo_settings_sites_list.find("#wpo_all_sites"),wpo_sitelist_show_moreoptions_link=$("#wpo_sitelist_show_moreoptions"),wpo_sitelist_moreoptions_div=$("#wpo_sitelist_moreoptions"),wpo_settings_sites_list_cron=$("#wpo_settings_sites_list_cron"),wpo_settings_sites_list_cron_ul=wpo_settings_sites_list_cron.find("ul").first(),wpo_settings_sites_list_cron_items=$('input[type="checkbox"]',wpo_settings_sites_list_cron_ul),wpo_settings_all_sites_cron_checkbox=wpo_settings_sites_list_cron.find("#wpo_all_sites_cron"),wpo_sitelist_show_moreoptions_cron_link=$("#wpo_sitelist_show_moreoptions_cron"),wpo_sitelist_moreoptions_cron_div=$("#wpo_sitelist_moreoptions_cron");define_moreoptions_settings(wpo_sitelist_show_moreoptions_link,wpo_sitelist_moreoptions_div,wpo_settings_all_sites_checkbox,wpo_settings_sites_list_items);var sites_list_clicked_count=0;$([wpo_settings_all_sites_checkbox,wpo_settings_sites_list_items]).each(function(){$(this).on("change",function(){sites_list_clicked_count++,setTimeout(function(){sites_list_clicked_count--,0==sites_list_clicked_count&&update_optimizations_info()},1e3)})}),define_moreoptions_settings(wpo_sitelist_show_moreoptions_cron_link,wpo_sitelist_moreoptions_cron_div,wpo_settings_all_sites_cron_checkbox,wpo_settings_sites_list_cron_items),$("#wp_optimize_table_list_refresh").click(function(t){t.preventDefault(),$("#wpoptimize_table_list tbody").css("opacity","0.5"),send_command("get_table_list",!1,function(t){if(t.hasOwnProperty("table_list")){var e=!0,i=function(t){$("#wpoptimize_table_list tbody").css("opacity","1")};$("#wpoptimize_table_list tbody").remove(),$("#wpoptimize_table_list thead").after(t.table_list),$("#wpoptimize_table_list").trigger("updateAll",[e,i])}t.hasOwnProperty("total_size")&&$("#optimize_current_db_size").html(t.total_size),change_actions_column_visibility(),update_single_table_optimization_buttons(single_table_optimization_force.is(":checked"))})}),$("#settings_form").on("click","#wp-optimize-settings-save",function(t){if(t.preventDefault(),!validate_logger_settings())return!1;console.log("What?"),$("#save_spinner").show();var e=gather_settings();send_command("save_settings",e,function(t){if($("#save_spinner").hide(),$("#save_done").show().delay(5e3).fadeOut(),t&&t.hasOwnProperty("save_results")&&t.save_results&&t.save_results.hasOwnProperty("errors")){for(var e=0,i=t.save_results.errors.length;e<i;e++){var o='<div class="error">'+t.errors[e]+"</div>";temporarily_display_notice(o,"#wp-optimize-settings-save-results")}console.log(t.save_results.messages)}t&&t.hasOwnProperty("status_box_contents")&&$("#wp_optimize_status_box .inside").html(t.status_box_contents),t&&t.hasOwnProperty("optimizations_table")&&$("#optimizations_list").replaceWith(t.optimizations_table),t.save_results.refresh&&location.reload()})}),$("#wp_optimize_status_box").on("click","#wp_optimize_status_box_refresh",function(t){t.preventDefault(),$("#wp_optimize_status_box").css("opacity","0.5"),send_command("get_status_box_contents",null,function(t){$("#wp_optimize_status_box").css("opacity","1").find(".inside").html(t)})});var optimization_force_checkbox=$("#innodb_force_optimize"),optimization_force=optimization_force_checkbox.is(":checked"),optimization_row=optimization_force_checkbox.closest("tr"),single_table_optimization_force=$("#innodb_force_optimize_single");optimization_force_checkbox.on("change",function(){$('button, input[type="checkbox"]',optimization_row).each(function(){optimization_force=optimization_force_checkbox.is(":checked");var t=$(this);t.data("disabled")&&(optimization_force?t.prop("disabled",!1):t.prop("disabled",!0))})}),$("#wpoptimize_table_list").on("click",".run-single-table-optimization",function(){var t=$("#enable-auto-backup-1"),e=$(this);t.is(":checked")?take_a_backup_with_updraftplus(function(){run_single_table_optimization(e)}):run_single_table_optimization(e)}),single_table_optimization_force.change(function(){update_single_table_optimization_buttons(single_table_optimization_force.is(":checked"))}),update_single_table_optimization_buttons(single_table_optimization_force.is(":checked"));var get_optimizations_info_cache={};$("#wpo_import_settings_btn").on("click",function(t){var e=$("#wpo_import_settings_file"),i=e.val(),o=e[0].files[0],n=new FileReader;return $("#wpo_import_settings_btn").prop("disabled",!0),/\.json$/.test(i)?(n.onload=function(){import_settings(this.result)},n.readAsText(o),!1):(t.preventDefault(),$("#wpo_import_settings_btn").prop("disabled",!1),$("#wpo_import_error_message").text(wpoptimize.please_select_settings_file).slideDown(),!1)}),$("#wpo_import_settings_file").on("change",function(){$("#wpo_import_error_message").slideUp()}),$("#wpo_export_settings_btn").on("click",function(t){return wpo_download_json_file(gather_settings("object")),!1});var optimization_get_info=function(t,e,i){return send_command("get_optimization_info",{optimization_id:e,data:i},function(i){var o=i&&i.result&&i.result.meta?i.result.meta:{},n=i&&i.result&&i.result.output?i.result.output.join("<br>"):"...";$(document).trigger(["optimization_get_info_",e].join(""),n),t.html(n),o.finished?$(document).trigger(["optimization_get_info_",e,"_done"].join(""),i):setTimeout(function(){optimization_get_info(t,e,o)},1)})};return $(document).ready(function(){$(".wp-optimize-optimization-info-ajax").each(function(){var t=$(this),e=t.parent(),i=t.data("id");$(document).trigger(["optimization_get_info_",i,"_start"].join("")),optimization_get_info(e,i,{support_ajax_get_info:!0})})}),$("#wpoptimize_table_list").on("click",".run-single-table-repair",function(){var t=$(this),e=t.next(),i=e.next(),o=t.data("table"),n={optimization_id:"repairtables",optimization_table:o};e.removeClass("visibility-hidden"),send_command("do_optimization",{optimization_id:"repairtables",data:n},function(n){if(n.result.meta.success){var s=t.closest("tr"),a=n.result.meta.tableinfo;t.prop("disabled",!1),e.addClass("visibility-hidden"),i.show().removeClass("visibility-hidden"),update_single_table_information(s,a),setTimeout(function(){var e=t.closest("td"),i=t.closest(".wpo_button_wrap");i.fadeOut("fast",function(){i.closest(".wpo_button_wrap").remove(),a.is_type_supported&&$(".wpo_button_wrap",e).removeClass("wpo_hidden")}),change_actions_column_visibility()},1e3)}else t.prop("disabled",!1),e.addClass("visibility-hidden"),alert(wpoptimize.table_was_not_repaired.replace("%s",o))})}),$("#wpoptimize_table_list").on("click",".run-single-table-delete",function(){if(!confirm(wpoptimize.are_you_sure_you_want_to_remove_this_table))return!1;var t=$("#enable-auto-backup-1");t.is(":checked")?take_a_backup_with_updraftplus(remove_single_db_table($(this))):remove_single_db_table($(this))}),change_actions_column_visibility(),setTimeout(function(){send_command("check_overdue_crons",null,function(t){t&&t.hasOwnProperty("m")&&$("#wpo_settings_warnings").append(t.m)})},11e3),$(".wpo-introduction-notice .notice-dismiss, .wpo-introduction-notice .close").on("click",function(t){$(".wpo-introduction-notice").remove(),send_command("dismiss_install_or_update_notice",null,function(t){t&&t.hasOwnProperty("error")&&console.log("There was an error dismissing the install or update notice (dismiss_install_or_update_notice)",t)})}),{send_command:send_command,optimization_get_info:optimization_get_info,take_a_backup_with_updraftplus:take_a_backup_with_updraftplus,save_auto_backup_options:save_auto_backup_options}};jQuery(document).ready(function(t){function e(e){var i=["#",e.data("additional")].join("");e.is(":checked")?t(i).show():t(i).hide()}function i(){var e=t("#wp-optimize-logger-settings .save_settings_reminder");e.is(":visible")||e.slideDown("normal")}function o(){t(".wpo_logger_type").each(function(){n(t(this))})}function n(e){var i,o,n=s();for(i in n)o=n[i],wpoptimize.loggers_classes_info[o].allow_multiple?t('option[value="'+o+'"]',e).show():t('option[value="'+o+'"]',e).hide()}function s(){var e=[];return t(".wpo_logging_row, .wpo_logger_type").each(function(){var i=t(this).is("select")?t(this).val():t(this).data("id");i&&e.push(i)}),e}function a(){var t,e=['<option value="">Select destination</option>'];for(t in wpoptimize.loggers_classes_info)wpoptimize.loggers_classes_info.hasOwnProperty(t)&&wpoptimize.loggers_classes_info[t].available&&e.push(['<option value="',t,'">',wpoptimize.loggers_classes_info[t].description,"</option>"].join(""));return['<div class="wpo_add_logger_form">','<select class="wpo_logger_type" name="wpo-logger-type[]">',e.join(""),"<select>",'<a href="#" class="wpo_delete_logger dashicons dashicons-no-alt"></a>','<div class="wpo_additional_logger_options"></div>',"</div>"].join("")}function _(e){if(!wpoptimize.loggers_classes_info[e].options)return"";var i,o=wpoptimize.loggers_classes_info[e].options,n=[],s="",a="";for(i in o)o.hasOwnProperty(i)&&(t.isArray(o[i])?(s=t.trim(o[i][0]),a=t.trim(o[i][1])):(s=t.trim(o[i]),a=""),n.push(['<input class="wpo_logger_addition_option" type="text" name="wpo-logger-options[',i,'][]" value="" ','placeholder="',s,'" ',""!==a?'data-validate="'+a+'"':"","/>"].join("")));return n.push('<input type="hidden" name="wpo-logger-options[active][]" value="1" />'),n.join("")}t(".wp-optimize-logging-settings").each(function(){var i=t(this);e(i),i.on("change",function(){e(i)})});var p=t("#wpo_add_logger_link");p.on("click",function(e){e.preventDefault(),t("#wp-optimize-logger-settings .save_settings_reminder").after(a()),n(t(".wpo_logger_type").first())}),t("#wp-optimize-general-settings").on("change",".wpo_logger_type",function(){var e=t(this),o=e.val(),n=e.parent().find(".wpo_additional_logger_options");n.html(_(o)),e.val()&&i()}),t(".wpo_logging_actions_row .dashicons-edit").on("click",function(){var e=t(this),i=e.closest(".wpo_logging_row");return t(".wpo_additional_logger_options",i).removeClass("wpo_hidden"),t(".wpo_logging_options_row",i).text(""),t(".wpo_logging_status_row",i).text(""),e.hide(),!1}),t("#wp-optimize-logger-settings").on("change",".wpo_logger_addition_option",function(){i()}),t(".wpo_logger_active_checkbox").on("change",function(){var e=t(this),i=e.closest("label").find('input[type="hidden"]');i.val(e.is(":checked")?"1":"0")}),t("#wp-optimize-general-settings").on("click",".wpo_delete_logger",function(){if(!confirm(wpoptimize.are_you_sure_you_want_to_remove_logging_destination))return!1;var e=t(this);return e.closest(".wpo_logging_row, .wpo_add_logger_form").remove(),o(),0==t("#wp-optimize-logging-options .wpo_logging_row").length&&t("#wp-optimize-logging-options").hide(),i(),!1});var l=!1;t(window).on("scroll",function(e){window.requestAnimationFrame(function(){var e=t(".wpo-main-header").length?t(".wpo-main-header")[0].offsetTop:0;window.pageYOffset>e-20!=l&&(l=!l,t("body").toggleClass("is-scrolled",l))})}),t(".wpo-info__trigger").on("click",function(e){e.preventDefault();var i=t(this).closest(".wpo-info");i.toggleClass("opened")}),t(".wpo-video-preview a").on("click",function(e){var i=t(this).data("embed");if(i){e.preventDefault();var o=t('<iframe width="356" height="200" allowfullscreen webkitallowfullscreen mozallowfullscreen>').attr("src",i);o.insertAfter(t(this)),t(this).remove(),o.focus()}})});